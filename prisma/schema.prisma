generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Scout {
  id        String   @id @default(cuid())
  email     String   @unique
  password  String
  name      String
  role      String   @default("scout")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Invite {
  id        String   @id @default(cuid())
  email     String   @unique
  role      String   @default("scout")
  token     String   @unique
  used      Boolean  @default(false)
  createdAt DateTime @default(now())
  expiresAt DateTime
}

model ScoutingReport {
  id            String   @id @default(cuid())
  playerId      String
  playerName    String?
  position      String?
  club          String?
  scoutId       String?

  // Ability & Potential
  ability       Int?     // 1-5 scale
  potential     Int?     // 1-8 scale (Liga 3a → Superliga playoff)

  // Report Rating (1-5 FCB Scale)
  report        Int?     // 1=Well below FCB, 5=Well above FCB

  // Physical — Ability (1-5) + Potential (1-8)
  physStrength     Int?
  physStrengthPot  Int?
  physSpeed        Int?
  physSpeedPot     Int?
  physAgility      Int?
  physAgilityPot   Int?
  physCoordination Int?
  physCoordinationPot Int?

  // Technique — Ability (1-5) + Potential (1-8)
  techControl          Int?
  techControlPot       Int?
  techShortPasses      Int?
  techShortPassesPot   Int?
  techLongPasses       Int?
  techLongPassesPot    Int?
  techAerial           Int?
  techAerialPot        Int?
  techCrossing         Int?
  techCrossingPot      Int?
  techFinishing        Int?
  techFinishingPot     Int?
  techDribbling        Int?
  techDribblingPot     Int?
  techOneVsOneOffense  Int?
  techOneVsOneOffensePot Int?
  techOneVsOneDefense  Int?
  techOneVsOneDefensePot Int?

  // Tactic — Ability (1-5) + Potential (1-8)
  tacPositioning    Int?
  tacPositioningPot Int?
  tacTransition     Int?
  tacTransitionPot  Int?
  tacDecisions      Int?
  tacDecisionsPot   Int?
  tacAnticipations  Int?
  tacAnticipationsPot Int?
  tacDuels          Int?
  tacDuelsPot       Int?
  tacSetPieces      Int?
  tacSetPiecesPot   Int?

  // Scouting Tags (3 max, from categorized list)
  scoutingTags  String[] @default([])

  // Legacy — kept for backward compat
  strengths     String[] @default([])
  weaknesses    String[] @default([])

  // Verdict
  verdict       String?  // sign | observe | monitor | not_a_priority | out_of_reach

  // Role & Conclusion
  role          String?
  conclusion    String?
  notes         String?

  // Position-specific grading
  positionCategory  String?
  positionAttributes Json?

  // Metadata
  scoutName     String?
  status        String?  // FM | U23 | LOAN | WATCH
  scoutingLevel String?  // Basic | Impressive | Data only
  transferFee   String?
  salary        String?

  // Admin edit tracking
  editedBy      String?  // admin name who last edited
  editedById    String?  // admin scout ID
  editedAt      DateTime?

  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  // Legacy columns (kept for backward compat with existing data)
  ballControl    Int?
  passing        Int?
  dribbling      Int?
  finishing      Int?
  pace           Int?
  stamina        Int?
  strength       Int?
  positioning    Int?
  movement       Int?
  creativity     Int?
  decisionMaking Int?
  workRate       Int?
  discipline     Int?
  recommendation String?

  attachments   Attachment[]

  @@unique([playerId, scoutId])
  @@index([playerId])
  @@index([scoutId])
  @@index([verdict])
}

model Attachment {
  id        String   @id @default(cuid())
  reportId  String
  fileName  String
  fileType  String
  fileSize  Int
  url       String
  label     String?
  createdAt DateTime @default(now())

  report    ScoutingReport @relation(fields: [reportId], references: [id], onDelete: Cascade)

  @@index([reportId])
}
