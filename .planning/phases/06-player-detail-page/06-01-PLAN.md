---
phase: 06-player-detail-page
plan: 01
type: execute
---

<objective>
Create a full player profile page displaying all available player data.

Purpose: Allow scouts to view complete player information after finding them via search.
Output: Dynamic player detail page accessible from search results.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-filtering-system/05-01-SUMMARY.md

# Key files from prior phases:
@src/app/api/search/route.ts
@src/components/PlayerCard.tsx
@src/components/PlayerList.tsx
@src/types/player.ts

**Tech stack available:** Next.js 14, React, Tailwind CSS
**Established patterns:** API routes, client components, SearchPlayer type
**Constraining decisions:**
- [Phase 3]: JSON file as data source (in-memory search)
- [Phase 3]: SearchPlayer includes `playerId` (from TM URL) and `url`
- [Phase 4]: PlayerCard component displays basic player info
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create player detail API endpoint</name>
  <files>src/app/api/player/[id]/route.ts</files>
  <action>
Create GET endpoint for fetching a single player by playerId:

1. Create dynamic route at `src/app/api/player/[id]/route.ts`

2. Reuse player loading logic from search API:
   - Import or duplicate the loadPlayers() and normalizePlayer() functions
   - Better: Extract shared logic to `src/lib/players.ts` for reuse

3. Find player by matching:
   - First try: playerId match (extracted from TM URL)
   - Fallback: exact name match (URL-decoded)

4. Return single player object or 404:
   - Found: Return full player data as JSON
   - Not found: Return `{ error: "Player not found" }` with 404 status

5. Add additional fields to response that aren't in SearchPlayer:
   - `leagueUrl`: The givenUrl from JSON (competition URL)

Do NOT duplicate the entire search API code - extract shared player loading to a lib file.
  </action>
  <verify>
curl http://localhost:3000/api/player/820633 returns player JSON
curl http://localhost:3000/api/player/nonexistent returns 404
  </verify>
  <done>
- Player API endpoint exists at /api/player/[id]
- Returns full player data for valid ID
- Returns 404 for invalid ID
- Shared player loading logic extracted to lib
  </done>
</task>

<task type="auto">
  <name>Task 2: Create player detail page</name>
  <files>src/app/player/[id]/page.tsx</files>
  <action>
Create dynamic player detail page:

1. Create page at `src/app/player/[id]/page.tsx`
   - Server component that fetches player data
   - Use Next.js 14 App Router patterns

2. Fetch player data:
   - Call internal API: `/api/player/${id}`
   - Handle loading and error states
   - Show "Player not found" for 404

3. Display all available player information:
   - Large header section with name and position
   - Key stats in a grid: Age, Club, Market Value, Nationality
   - Link to Transfermarkt (external, opens new tab) if URL available
   - Back button to return to search

4. Style with Tailwind CSS:
   - Consistent dark/light theme with existing components
   - Responsive layout (stack on mobile, side-by-side on desktop)
   - Card-style sections for organization
   - max-w-2xl centered container

5. Handle edge cases:
   - Missing data fields show "-" or appropriate placeholder
   - Multiple nationalities displayed as comma-separated list
  </action>
  <verify>
Visit http://localhost:3000/player/820633 shows player details
Visit http://localhost:3000/player/invalid shows "Player not found"
  </verify>
  <done>
- Player detail page renders at /player/[id]
- Shows all available player data
- Handles missing data gracefully
- Has back navigation
- Responsive layout
  </done>
</task>

<task type="auto">
  <name>Task 3: Make PlayerCard clickable with navigation</name>
  <files>src/components/PlayerCard.tsx</files>
  <action>
Add click navigation to PlayerCard:

1. Import Next.js Link or useRouter:
   - Use Next.js Link component for client-side navigation
   - Wrap the entire card in Link

2. Build player URL:
   - Primary: `/player/${player.playerId}` if playerId exists
   - Fallback: `/player/${encodeURIComponent(player.name)}` for players without ID

3. Update card styling:
   - Already has `cursor-pointer` and `hover:shadow-md`
   - Ensure Link doesn't break existing styles
   - Add focus state for accessibility

4. Preserve existing card layout:
   - Keep all current content
   - Link should wrap the outer div

Do NOT change the card's visual appearance - only add navigation.
  </action>
  <verify>
1. `npm run build` succeeds
2. Click on player card navigates to /player/[id]
3. Card hover effects still work
  </verify>
  <done>
- PlayerCard navigates to detail page on click
- Uses playerId when available, name as fallback
- Existing styles preserved
- Build passes
  </done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `npm run build` succeeds without errors
- [ ] Player API returns correct data for valid IDs
- [ ] Player detail page displays all available fields
- [ ] Clicking PlayerCard navigates to detail page
- [ ] Back navigation works from detail page
- [ ] Dark mode styling consistent
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No TypeScript errors
- Full player detail flow works end-to-end (search → click → detail → back)
</success_criteria>

<output>
After completion, create `.planning/phases/06-player-detail-page/06-01-SUMMARY.md`:

# Phase 6 Plan 01: Player Detail Page Summary

**[Substantive one-liner]**

## Performance

- **Duration:** X min
- **Started:** timestamp
- **Completed:** timestamp
- **Tasks:** 3
- **Files modified:** N

## Accomplishments

- [Key outcome 1]
- [Key outcome 2]

## Task Commits

1. **Task 1: Create player detail API** - `hash` (feat)
2. **Task 2: Create player detail page** - `hash` (feat)
3. **Task 3: Make PlayerCard clickable** - `hash` (feat)

## Files Created/Modified

- `src/lib/players.ts` - Shared player loading logic
- `src/app/api/player/[id]/route.ts` - Player detail API
- `src/app/player/[id]/page.tsx` - Player detail page
- `src/components/PlayerCard.tsx` - Added navigation

## Decisions Made

| Decision | Rationale |
|----------|-----------|
| ... | ... |

## Deviations from Plan

None / describe any

## Issues Encountered

None / describe any

## Next Phase Readiness

Phase 6 complete. Ready for **Phase 7: UI Polish**:
- Player detail page complete
- Full search → detail flow working
</output>
