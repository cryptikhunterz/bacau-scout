---
phase: 09-scout-grading
plan: 04
type: execute
---

<objective>
Transform home page into graded players dashboard with search, filters, and sortable table.

Purpose: Provide scouts with a command center showing all graded players with filtering and sorting.
Output: Home page displaying grades table with search bar, filters, and navigation to profiles.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./09-04-SUMMARY.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@src/app/page.tsx
@src/components/SearchBar.tsx
@src/lib/grades.ts

**Prior plan outputs:**
- PlayerGrade interface with all rating fields
- getAllGrades() returns array of graded players
- Working grading on player profile
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create GradesTable component</name>
  <files>src/components/GradesTable.tsx</files>
  <action>
Create sortable grades table component:

```typescript
'use client';

import { useState } from 'react';
import Link from 'next/link';
import { PlayerGrade, CATEGORY_LABELS } from '@/lib/grades';

interface GradesTableProps {
  grades: PlayerGrade[];
}

type SortKey = 'playerName' | 'position' | 'abilityRating' | 'potentialRating' | 'recommendation' | 'playerCategory';

export function GradesTable({ grades }: GradesTableProps) {
  const [sortKey, setSortKey] = useState<SortKey>('gradedAt');
  const [sortDir, setSortDir] = useState<'asc' | 'desc'>('desc');

  const handleSort = (key: SortKey) => {
    if (sortKey === key) {
      setSortDir(sortDir === 'asc' ? 'desc' : 'asc');
    } else {
      setSortKey(key);
      setSortDir('asc');
    }
  };

  const sorted = [...grades].sort((a, b) => {
    const aVal = a[sortKey];
    const bVal = b[sortKey];
    const cmp = aVal < bVal ? -1 : aVal > bVal ? 1 : 0;
    return sortDir === 'asc' ? cmp : -cmp;
  });

  // Render stars as ★★★☆☆
  const renderStars = (n: number) => '★'.repeat(n) + '☆'.repeat(5 - n);

  // Recommendation badge colors
  const recColors = {
    Sign: 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300',
    Monitor: 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300',
    Discard: 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300',
  };

  return (
    <div className="overflow-x-auto">
      <table className="w-full text-sm">
        <thead>
          <tr className="border-b border-zinc-200 dark:border-zinc-700">
            <SortHeader label="Player" sortKey="playerName" current={sortKey} onClick={handleSort} />
            <SortHeader label="Pos" sortKey="position" current={sortKey} onClick={handleSort} />
            <th className="text-left py-2 px-2">Club</th>
            <SortHeader label="Cat" sortKey="playerCategory" current={sortKey} onClick={handleSort} />
            <SortHeader label="Ability" sortKey="abilityRating" current={sortKey} onClick={handleSort} />
            <SortHeader label="Potential" sortKey="potentialRating" current={sortKey} onClick={handleSort} />
            <SortHeader label="Rec" sortKey="recommendation" current={sortKey} onClick={handleSort} />
            <th className="text-center py-2 px-1">Tech</th>
            <th className="text-center py-2 px-1">Tact</th>
            <th className="text-center py-2 px-1">Phys</th>
            <th className="text-center py-2 px-1">Ment</th>
          </tr>
        </thead>
        <tbody>
          {sorted.map((grade) => (
            <Link
              key={grade.playerId}
              href={`/player/${grade.playerId}`}
              className="contents"
            >
              <tr className="border-b border-zinc-100 dark:border-zinc-800 hover:bg-zinc-50 dark:hover:bg-zinc-800 cursor-pointer">
                <td className="py-2 px-2 font-medium">{grade.playerName}</td>
                <td className="py-2 px-2 text-zinc-500">{grade.position}</td>
                <td className="py-2 px-2 text-zinc-500">{grade.club}</td>
                <td className="py-2 px-2">{grade.playerCategory}</td>
                <td className="py-2 px-2 text-center">{grade.abilityRating}</td>
                <td className="py-2 px-2 text-center">{grade.potentialRating}</td>
                <td className="py-2 px-2">
                  <span className={`px-2 py-0.5 rounded text-xs font-medium ${recColors[grade.recommendation]}`}>
                    {grade.recommendation}
                  </span>
                </td>
                <td className="py-2 px-1 text-center text-yellow-500 text-xs">{renderStars(grade.technicalRating)}</td>
                <td className="py-2 px-1 text-center text-yellow-500 text-xs">{renderStars(grade.tacticalRating)}</td>
                <td className="py-2 px-1 text-center text-yellow-500 text-xs">{renderStars(grade.physicalRating)}</td>
                <td className="py-2 px-1 text-center text-yellow-500 text-xs">{renderStars(grade.mentalRating)}</td>
              </tr>
            </Link>
          ))}
        </tbody>
      </table>
    </div>
  );
}

// SortHeader helper component
function SortHeader({ label, sortKey, current, onClick }) {
  return (
    <th
      className="text-left py-2 px-2 cursor-pointer hover:text-blue-600"
      onClick={() => onClick(sortKey)}
    >
      {label} {current === sortKey && '↕'}
    </th>
  );
}
```

Note: Link wrapping tr doesn't work directly - use onClick with router.push instead.
  </action>
  <verify>Component compiles without errors</verify>
  <done>GradesTable with sortable columns, star displays, and colored recommendation badges</done>
</task>

<task type="auto">
  <name>Task 2: Create GradesFilters component</name>
  <files>src/components/GradesFilters.tsx</files>
  <action>
Create filter controls for grades table:

```typescript
'use client';

interface GradesFiltersProps {
  filters: {
    recommendation: string;
    minAbility: number;
    position: string;
  };
  onChange: (filters: GradesFiltersProps['filters']) => void;
}

export function GradesFilters({ filters, onChange }: GradesFiltersProps) {
  return (
    <div className="flex flex-wrap gap-4 items-center">
      {/* Recommendation toggle buttons */}
      <div className="flex gap-1">
        {['All', 'Sign', 'Monitor', 'Discard'].map((rec) => (
          <button
            key={rec}
            onClick={() => onChange({ ...filters, recommendation: rec === 'All' ? '' : rec })}
            className={`px-3 py-1 text-sm rounded ${
              (rec === 'All' && !filters.recommendation) || filters.recommendation === rec
                ? 'bg-zinc-800 text-white dark:bg-white dark:text-zinc-900'
                : 'bg-zinc-100 dark:bg-zinc-800'
            }`}
          >
            {rec}
          </button>
        ))}
      </div>

      {/* Min Ability dropdown */}
      <select
        value={filters.minAbility}
        onChange={(e) => onChange({ ...filters, minAbility: Number(e.target.value) })}
        className="px-3 py-1 text-sm rounded border border-zinc-200 dark:border-zinc-700 bg-white dark:bg-zinc-800"
      >
        <option value={0}>Min Ability: All</option>
        {[1, 2, 3, 4, 5].map((n) => (
          <option key={n} value={n}>Min Ability: {n}+</option>
        ))}
      </select>

      {/* Position dropdown */}
      <select
        value={filters.position}
        onChange={(e) => onChange({ ...filters, position: e.target.value })}
        className="px-3 py-1 text-sm rounded border border-zinc-200 dark:border-zinc-700 bg-white dark:bg-zinc-800"
      >
        <option value="">Position: All</option>
        <option value="Goalkeeper">GK</option>
        <option value="Defender">DEF</option>
        <option value="Midfielder">MID</option>
        <option value="Forward">FWD</option>
      </select>
    </div>
  );
}
```
  </action>
  <verify>Component compiles without errors</verify>
  <done>GradesFilters with recommendation toggles, min ability dropdown, position filter</done>
</task>

<task type="auto">
  <name>Task 3: Transform home page to grades dashboard</name>
  <files>src/app/page.tsx</files>
  <action>
Rewrite home page as grades dashboard:

```typescript
'use client';

import { useState, useEffect } from 'react';
import { SearchBar } from '@/components/SearchBar';
import { GradesTable } from '@/components/GradesTable';
import { GradesFilters } from '@/components/GradesFilters';
import { getAllGrades, PlayerGrade } from '@/lib/grades';

export default function Home() {
  const [grades, setGrades] = useState<PlayerGrade[]>([]);
  const [filters, setFilters] = useState({
    recommendation: '',
    minAbility: 0,
    position: '',
  });

  useEffect(() => {
    setGrades(getAllGrades());
  }, []);

  // Apply filters
  const filteredGrades = grades.filter((g) => {
    if (filters.recommendation && g.recommendation !== filters.recommendation) return false;
    if (filters.minAbility && g.abilityRating < filters.minAbility) return false;
    if (filters.position && !g.position.toLowerCase().includes(filters.position.toLowerCase())) return false;
    return true;
  });

  // Summary stats
  const signCount = grades.filter((g) => g.recommendation === 'Sign').length;
  const monitorCount = grades.filter((g) => g.recommendation === 'Monitor').length;
  const discardCount = grades.filter((g) => g.recommendation === 'Discard').length;

  return (
    <div className="min-h-screen bg-zinc-50 dark:bg-zinc-900">
      {/* Header */}
      <header className="bg-white dark:bg-zinc-800 border-b border-zinc-200 dark:border-zinc-700 py-4">
        <div className="container mx-auto px-4">
          <h1 className="text-xl font-bold text-zinc-900 dark:text-white">
            FC Bacau Scout Database
          </h1>
          <p className="text-sm text-zinc-500 mt-1">
            {grades.length} players graded | {signCount} Sign | {monitorCount} Monitor | {discardCount} Discard
          </p>
        </div>
      </header>

      <main className="container mx-auto px-4 py-6">
        {/* Search Bar */}
        <div className="mb-6">
          <SearchBar />
        </div>

        {/* Filters */}
        <div className="mb-4">
          <GradesFilters filters={filters} onChange={setFilters} />
        </div>

        {/* Grades Table */}
        <div className="bg-white dark:bg-zinc-800 rounded-lg shadow-sm border border-zinc-200 dark:border-zinc-700 p-4">
          {filteredGrades.length > 0 ? (
            <GradesTable grades={filteredGrades} />
          ) : grades.length === 0 ? (
            <p className="text-center text-zinc-500 py-8">
              No players graded yet. Search for a player to start scouting.
            </p>
          ) : (
            <p className="text-center text-zinc-500 py-8">
              No players match current filters.
            </p>
          )}
        </div>
      </main>
    </div>
  );
}
```

Keep existing SearchBar component - it already navigates to /player/[id].
Remove old footer (player count).
  </action>
  <verify>Build succeeds and home page shows grades dashboard</verify>
  <done>Home page transformed to grades dashboard with header, search, filters, and table</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete scout grading system with home dashboard</what-built>
  <how-to-verify>
    1. Run: cd /Users/ocoulibaly/Desktop/bacau-scout && npm run dev
    2. Visit: http://localhost:3000

    TEST 1 - Grade a player:
    3. Search for "Suciu", click result
    4. Fill grading form: FM, Sign, Category 5, Ability 3.5, Potential 4.0
    5. Add stars: Tech 4, Tact 3, Phys 3, Ment 4
    6. Save → should show success

    TEST 2 - See grade on home:
    7. Click "Back to Search" or navigate to /
    8. Antonio Suciu should appear in table
    9. Verify recommendation badge is green (Sign)
    10. Verify stars display correctly

    TEST 3 - Filter grades:
    11. Grade 1-2 more players with different recommendations
    12. Go home, click "Sign" filter → only Sign players shown
    13. Click "Monitor" → only Monitor shown
    14. Click "All" → shows all

    TEST 4 - Sort table:
    15. Click "Ability" header → sorts by ability
    16. Click "Potential" → sorts by potential

    TEST 5 - Edit grade:
    17. Click graded player row → profile
    18. Form shows existing values
    19. Change recommendation to Monitor, save
    20. Go home → badge is now yellow
  </how-to-verify>
  <resume-signal>Type "approved" if all tests pass, or describe issues</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds
- [ ] Home page shows grades dashboard
- [ ] Search bar navigates to player profiles
- [ ] Filters work (recommendation, ability, position)
- [ ] Table columns are sortable
- [ ] Clicking row navigates to player profile
- [ ] Complete grading flow works end-to-end
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Human verification approved
- Full scout grading workflow operational
</success_criteria>

<output>
After completion, create `.planning/phases/09-scout-grading/09-04-SUMMARY.md`:

# Phase 9 Plan 4: Home Page Transformation Summary

**Scout grading dashboard with filterable, sortable grades table**

## Accomplishments
- Created GradesTable component with sortable columns
- Created GradesFilters component with recommendation/ability/position filters
- Transformed home page to grades dashboard
- Summary stats in header (X graded, Y Sign, Z Monitor, W Discard)
- Empty state messaging

## Files Created/Modified
- `src/components/GradesTable.tsx` - Sortable grades table
- `src/components/GradesFilters.tsx` - Filter controls
- `src/app/page.tsx` - Grades dashboard

## Phase Complete
Phase 9 (Scout Grading System) is complete. All 4 plans executed successfully.
</output>
