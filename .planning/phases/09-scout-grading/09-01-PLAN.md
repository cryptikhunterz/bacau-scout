---
phase: 09-scout-grading
plan: 01
type: execute
---

<objective>
Create data model and localStorage helpers for scout grading system.

Purpose: Establish type-safe foundation for storing player evaluations locally.
Output: Working lib/grades.ts with PlayerGrade interface and CRUD helpers.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./09-01-SUMMARY.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@src/types/player.ts
@src/lib/players.ts

**Prior decisions:**
- localStorage for prototype (no cloud database)
- Storage key: "bacau-scout-grades"
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create PlayerGrade interface and category labels</name>
  <files>src/lib/grades.ts</files>
  <action>
Create src/lib/grades.ts with:

1. PlayerGrade interface:
```typescript
export interface PlayerGrade {
  playerId: string;           // TM player ID
  playerName: string;         // For display
  position: string;           // From TM data
  club: string;               // From TM data
  gradedAt: string;           // ISO timestamp

  // Status & Recommendation
  status: "FM" | "U23" | "LOAN" | "WATCH";
  recommendation: "Sign" | "Monitor" | "Discard";
  scoutingLevel: "Basic" | "Impressive" | "Data only";

  // Player Category (1-8)
  playerCategory: 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8;

  // Ability Ratings (1-5, 0.5 increments)
  abilityRating: number;
  potentialRating: number;

  // Star Ratings (1-5)
  technicalRating: number;
  tacticalRating: number;
  physicalRating: number;
  mentalRating: number;

  // Optional
  notes: string;
  transferFee?: string;
  salary?: string;
}
```

2. Category labels constant:
```typescript
export const CATEGORY_LABELS: Record<number, string> = {
  1: "Liga 1a Player",
  2: "Relegated Player",
  3: "Adequate Player",
  4: "Pay-off player",
  5: "Promotion/championship player",
  6: "European Player",
  7: "Europa top leagues",
  8: "Europa top player"
};
```

3. Type exports for Status, Recommendation, ScoutingLevel, PlayerCategory
  </action>
  <verify>TypeScript compiles without errors: cd /Users/ocoulibaly/Desktop/bacau-scout && npx tsc --noEmit src/lib/grades.ts</verify>
  <done>PlayerGrade interface defined with all fields, CATEGORY_LABELS exported</done>
</task>

<task type="auto">
  <name>Task 2: Implement localStorage CRUD helpers</name>
  <files>src/lib/grades.ts</files>
  <action>
Add to src/lib/grades.ts:

1. Storage key constant:
```typescript
const STORAGE_KEY = "bacau-scout-grades";
```

2. Helper functions (client-side only - use 'use client' or check typeof window):

```typescript
export function getAllGrades(): PlayerGrade[] {
  if (typeof window === 'undefined') return [];
  const data = localStorage.getItem(STORAGE_KEY);
  return data ? JSON.parse(data) : [];
}

export function getGrade(playerId: string): PlayerGrade | null {
  const grades = getAllGrades();
  return grades.find(g => g.playerId === playerId) || null;
}

export function saveGrade(grade: PlayerGrade): void {
  const grades = getAllGrades();
  const existingIndex = grades.findIndex(g => g.playerId === grade.playerId);

  if (existingIndex >= 0) {
    grades[existingIndex] = { ...grade, gradedAt: new Date().toISOString() };
  } else {
    grades.push({ ...grade, gradedAt: new Date().toISOString() });
  }

  localStorage.setItem(STORAGE_KEY, JSON.stringify(grades));
}

export function deleteGrade(playerId: string): void {
  const grades = getAllGrades().filter(g => g.playerId !== playerId);
  localStorage.setItem(STORAGE_KEY, JSON.stringify(grades));
}
```

IMPORTANT: Add "use client" directive at top since localStorage is browser-only.
  </action>
  <verify>Build succeeds: cd /Users/ocoulibaly/Desktop/bacau-scout && npm run build</verify>
  <done>All 4 CRUD functions implemented: getAllGrades, getGrade, saveGrade, deleteGrade</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] src/lib/grades.ts exports PlayerGrade interface
- [ ] src/lib/grades.ts exports CATEGORY_LABELS
- [ ] src/lib/grades.ts exports all 4 CRUD functions
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No TypeScript errors
- Ready for GradingForm component to use these helpers
</success_criteria>

<output>
After completion, create `.planning/phases/09-scout-grading/09-01-SUMMARY.md`
</output>
